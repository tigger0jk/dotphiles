# .bashrc

# Source global definitions
if [ -f /etc/bashrc ]; then
	. /etc/bashrc
fi

# User specific aliases and functions

platform='unknown'
unamestr=`uname`
if [[ "$unamestr" == 'Linux' ]]; then
  platform='linux'
elif [[ "$unamestr" == 'FreeBSD' ]]; then
  platform='freebsd'
elif [[ "$unamestr" == 'Darwin'* ]]; then
  platform='osx'
fi

# http://superuser.com/questions/39751/add-directory-to-path-if-its-not-already-there
pathadd() {
  # Check if the passed arg is a directory that exists and that it's not in the path
  if [ -d "$1" ] && [[ ":$PATH:" != *":$1:"* ]]; then
    # PATH="${PATH:+"$PATH:"}$1" # This adds to the end of PATH
    PATH="$1${PATH:+":$PATH"}" # This adds to the start of PATH
  fi
}

export EDITOR='vim';

if [[ ($platform == 'osx') ]]; then
  # for my local machine
  export JAVA_HOME=/usr/local/java/latest
  export ANDROID_HOME=/Users/$USER/Library/Android/sdk
  pathadd $ANDROID_HOME/platform-tools
  pathadd $ANDROID_HOME/tools
  # In theory this should be some command that sets sensitivity independent of accel but it doesn't fucking exist fuck you apple https://apple.stackexchange.com/questions/333989/how-do-i-disable-mouse-acceleration-and-adjust-tracking-speed-in-high-sierra
  # defaults write .GlobalPreferences com.apple.mouse.scaling -float 0.135
  defaults write .GlobalPreferences com.apple.mouse.scaling -1
else
  # for servers
  export JAVA_HOME=/usr/java/latest
fi

pathadd $JAVA_HOME/bin

#fast search in files, piped through cut to truncate long lines
function acki() {
  ack --ignore-dir=web-compiled "$@" | cut -c 1-200;
}

#fast case insensitive search in files, piped through cut to truncate long lines
function ackii() {
  ack -i --ignore-dir=web-compiled "$@" | cut -c 1-200;
}

#opens files with a specific name
#usage fo file.txt
function fo() {
   vi `find -name $@`
}

#shows files with a specific name
#usage f file.txt
function f() {
   find -name "$@"
}

#shows files with a specific name (case insensitive)
#not named fi because that is a reserved word in bash (endif)
#this ignores .git directories
#usage fii file.txt
#usage fii *File*
function fii() {
   find . -path "*/.git" -prune -o -iname "$@" -print
}

function dotf() {
  echo "cd ~/.dotfiles;"
  cd ~/.dotfiles;
}

alias subup='git submodule update'

#use color with ls
# this is the same as default LS colors except for changing ow from 34;42 to 30;44 so it looks good in monokai
LS_COLORS='rs=0:di=01;34:ln=01;36:mh=00:pi=40;33:so=01;35:do=01;35:bd=40;33;01:cd=40;33;01:or=40;31;01:mi=00:su=37;41:sg=30;43:ca=30;41:tw=30;42:ow=30;44:st=37;44:ex=01;32:*.tar=01;31:*.tgz=01;31:*.arc=01;31:*.arj=01;31:*.taz=01;31:*.lha=01;31:*.lz4=01;31:*.lzh=01;31:*.lzma=01;31:*.tlz=01;31:*.txz=01;31:*.tzo=01;31:*.t7z=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.dz=01;31:*.gz=01;31:*.lrz=01;31:*.lz=01;31:*.lzo=01;31:*.xz=01;31:*.zst=01;31:*.tzst=01;31:*.bz2=01;31:*.bz=01;31:*.tbz=01;31:*.tbz2=01;31:*.tz=01;31:*.deb=01;31:*.rpm=01;31:*.jar=01;31:*.war=01;31:*.ear=01;31:*.sar=01;31:*.rar=01;31:*.alz=01;31:*.ace=01;31:*.zoo=01;31:*.cpio=01;31:*.7z=01;31:*.rz=01;31:*.cab=01;31:*.wim=01;31:*.swm=01;31:*.dwm=01;31:*.esd=01;31:*.jpg=01;35:*.jpeg=01;35:*.mjpg=01;35:*.mjpeg=01;35:*.gif=01;35:*.bmp=01;35:*.pbm=01;35:*.pgm=01;35:*.ppm=01;35:*.tga=01;35:*.xbm=01;35:*.xpm=01;35:*.tif=01;35:*.tiff=01;35:*.png=01;35:*.svg=01;35:*.svgz=01;35:*.mng=01;35:*.pcx=01;35:*.mov=01;35:*.mpg=01;35:*.mpeg=01;35:*.m2v=01;35:*.mkv=01;35:*.webm=01;35:*.ogm=01;35:*.mp4=01;35:*.m4v=01;35:*.mp4v=01;35:*.vob=01;35:*.qt=01;35:*.nuv=01;35:*.wmv=01;35:*.asf=01;35:*.rm=01;35:*.rmvb=01;35:*.flc=01;35:*.avi=01;35:*.fli=01;35:*.flv=01;35:*.gl=01;35:*.dl=01;35:*.xcf=01;35:*.xwd=01;35:*.yuv=01;35:*.cgm=01;35:*.emf=01;35:*.ogv=01;35:*.ogx=01;35:*.aac=00;36:*.au=00;36:*.flac=00;36:*.m4a=00;36:*.mid=00;36:*.midi=00;36:*.mka=00;36:*.mp3=00;36:*.mpc=00;36:*.ogg=00;36:*.ra=00;36:*.wav=00;36:*.oga=00;36:*.opus=00;36:*.spx=00;36:*.xspf=00;36:';
export LS_COLORS
if [[ $platform == 'linux' ]]; then
  alias ls='ls --color=always'
elif [[ ($platform == 'freebsd') || ($platform == 'osx')]]; then
  alias ls='ls -G'
# elif [[ $platform == 'osx' ]]; then
  # alias ls='ls -G'
fi

#allows you to use this bashrc alias to automatically source this file after you modify it
alias bashrc='vi ~/.bashrc ; source ~/.bashrc'

#opens the vimrc source that I care about
alias vimrc='vi ~/.dotfiles/vim/dotvim/dotvim.vim;'

#word diff (pfay typically prefers this to standard git diff)
alias wdiff='git diff --color-words'

#character diff (helpful for seeing changes of a few characters within a word)
alias cdiff='git diff --word-diff-regex=.'

#I don't want to use vi for anything - use vim instead if I fuck it up
#Most distros map vi to vim already so this isn't really necessary
alias vi='vim'

#slow search (Find in Files)
function ff() {
  find . -regextype posix-egrep -type f ! -regex '.*/.git/.*' ! -iregex '.*\.(swf|gif|jpg|png|db|gz|jar)$' -exec grep -n "$@" '{}' /dev/null \;
}

#find in files piped to cut to truncate long lines (or huge files that are all on one line)
function ffc() {
  ff "$@" | cut -c 1-200;
}

# from http://unix.stackexchange.com/questions/159253/decoding-url-encoding-percent-encoding
alias urldecode='python -c "import sys, urllib as ul; print ul.unquote_plus(sys.argv[1])"'

alias urlencode='python -c "import sys, urllib as ul; print ul.quote_plus(sys.argv[1])"'

# alias rsa='ssh-add /home/pfay/.ssh/id_rsa'
alias rsa='eval `ssh-agent`; ssh-add'

alias jsonlint='python -m json.tool'
